{% extends "template.html" %}

{% block content %}
<h1>Alertes YouTube</h1>

<p>
	Liste des cha√Ænes YouTube surveill√©es pour les alertes de nouvelles vid√©os.
	Le bot v√©rifie r√©guli√®rement les nouvelles vid√©os publi√©es sur les cha√Ænes configur√©es.
	Lorsqu'une nouvelle vid√©o est d√©tect√©e, le bot envoie une notification sur le canal Discord configur√©.
</p>

{% if not alert %}
<h2>Cha√Ænes surveill√©es</h2>
<table class="youtube-alert">
	<thead>
		<tr>
			<th>Cha√Æne</th>
			<th>Canal Discord</th>
			<th>Message</th>
			<th>#</th>
		</tr>
	</thead>
	<tbody>
		{% for alert in alerts %}
		<tr>
			<td>
				<a href="https://www.youtube.com/channel/{{alert.channel_id}}" target="_blank">
					{{alert.channel_name or alert.channel_id}}
				</a>
			</td>
			<td>{{alert.notify_channel_name}}</td>
			<td>{{alert.message[:50]}}{% if alert.message|length > 50 %}...{% endif %}</td>
			<td>
				<a href="{{ url_for('toggleYoutubeAlert', id = alert.id) }}" class="icon">{{ '‚úÖ' if alert.enable else '‚ùå' }}</a>
				<a href="{{ url_for('openEditYoutubeAlert', id = alert.id) }}" class="icon">‚úê</a>
				<a href="{{ url_for('delYoutubeAlert', id = alert.id) }}"
					onclick="return confirm('√ätes-vous s√ªr de vouloir supprimer cette alerte ?')" class="icon">üóë</a>
			</td>
		</tr>
		{% endfor %}
	</tbody>
</table>
{% endif %}

<h2>{{ 'Editer une alerte' if alert else 'Ajouter une alerte YouTube' }}</h2>
<form action="{{ url_for('submitEditYoutubeAlert', id = alert.id) if alert else url_for('addYoutubeAlert') }}" method="POST">
	<label for="channel_id">ID de la cha√Æne YouTube</label>
	<input name="channel_id" type="text" maxlength="64" required="required" value="{{alert.channel_id if alert}}" placeholder="UCxxxxxxxxxxxxxxxxxxxxxxxx"/>
	
	<label for="notify_channel">Canal de Notification Discord</label>
	<select name="notify_channel">
		{% for channel in channels %}
		<option value="{{channel.id}}"{% if alert and alert.notify_channel == channel.id %}
			selected="selected" {% endif %}>{{channel.name}}</option>
		{% endfor %}
	</select>
	
	<label for="message">Message</label>
	<textarea name="message" rows="5" cols="50" required="required">{{alert.message if alert else 'üé¨ **Nouvelle vid√©o !**\n\n**{0.author}** vient de publier : **{0.title}**\n\nüëâ {0.link}'}}</textarea>
	
	<input type="Submit" value="{{ 'Modifier' if alert else 'Ajouter' }}">
	
	<h3>Comment trouver l'ID de cha√Æne YouTube ?</h3>
	<p>
		L'ID de cha√Æne YouTube commence par <code>UC</code> et contient 24 caract√®res.
	</p>
	<ol>
		<li>Allez sur la page de la cha√Æne YouTube</li>
		<li>Cliquez droit sur la page et choisissez "Afficher le code source"</li>
		<li>Recherchez <code>channelId</code> ou <code>externalId</code></li>
		<li>Copiez l'ID qui ressemble √† : <code>UCxxxxxxxxxxxxxxxxxxxxxxxx</code></li>
	</ol>
	<p>
		Vous pouvez aussi utiliser des outils en ligne comme <a href="https://commentpicker.com/youtube-channel-id.php" target="_blank">Comment Picker</a> pour trouver l'ID.
	</p>
	
	<h3>Variables disponibles pour le message</h3>
	<p>
		Pour le message vous avez acc√®s √† ces variables :
	</p>
	<ul>
		<li><code>{0.title}</code> : Titre de la vid√©o</li>
		<li><code>{0.author}</code> : Nom de la cha√Æne</li>
		<li><code>{0.link}</code> : Lien vers la vid√©o</li>
		<li><code>{0.video_id}</code> : ID de la vid√©o</li>
		<li><code>{0.thumbnail}</code> : URL de la miniature</li>
	</ul>
	<p>
		Le message est au format <a href="https://commonmark.org/" target="_blank">common-mark</a> dans la limite de ce que supporte Discord.
	</p>
</form>

{% endblock %}

