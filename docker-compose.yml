services:
  mamiehenriette:                                    
    container_name: MamieHenriette                  # Nom du conteneur
    image: ghcr.io/skylanix/mamiehenriette:latest   # Image hébergée sur GitHub Container Registry
    restart: unless-stopped                         # Redémarre automatiquement sauf si arrêté manuellement

#    build: .                                        # Build du conteneur à partir d'un Dockerfile local (décommentez si nécessaire)
#    image: mamiehenriette                           # Build du conteneur à partir d'un Dockerfile local (décommentez si nécessaire)

    environment:
        TZ: Europe/Paris                            # Fuseau horaire
    volumes:
      - ./instance:/app/instance                    # Base de données et configuration persistante
      - ./logs:/app/logs                            # Logs de l'application

    ports:
      - 5000:5000                                   # Interface web sur http://localhost:5000

  watchtower:                                       # Permet de mettre à jours automatiquement 
    image: containrrr/watchtower:latest
    container_name: watchtower                      # Nom du conteneur
    restart: unless-stopped                         # Redémarre automatiquement sauf si arrêté manuellement
    environment:
        TZ: Europe/Paris                            # Fuseau horaire
                                                    # Liste des conteneurs à surveiller (séparés par des espaces)
        WATCHTOWER_INCLUDE: "MamieHenriette"
        WATCHTOWER_SCHEDULE: "0 */30 * * * *"       # Vérification toutes les 30 minutes
        WATCHTOWER_MONITOR_ONLY: "false"            # Mode surveillance uniquement : détecte les mises à jour mais ne les applique pas
        WATCHTOWER_CLEANUP: "true"                  # Supprime automatiquement les anciennes images après mise à jour
        WATCHTOWER_INCLUDE_RESTARTING: "true"       # Inclut les conteneurs en cours de redémarrage dans la surveillance
                                                    # URL de notification Discord (webhook), (décommentez si nécessaire)
#        WATCHTOWER_NOTIFICATION_URL: "discord://token@id"
                                                    # Format personnalisé des messages de notification (décommentez si nécessaire)
#        WATCHTOWER_NOTIFICATION_TEMPLATE: |-
#          {{range .}}{{.Time.Format "01-02-2006 15:04:05"}} ({{.Level}})':' {{.Message}}{{println}}{{end}}
#        WATCHTOWER_NOTIFICATIONS: shoutrrr          # Service de notification utilisé pour Discord (décommentez si nécessaire)
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock   # Monte le socket Docker pour permettre à Watchtower de surveiller les conteneurs

#  sqlite-web:                                       # Interface web pour visualiser et éditer la base de données SQLite
#    image: ghcr.io/coleifer/sqlite-web:latest       # Image officielle sqlite-web
#    container_name: sqlite_web                      # Nom du conteneur
#    ports:
#      - "5001:8080"                                 # Accès web via localhost:8080
#    volumes:
#      - ./instance/database.db:/data/database.db    # Monte la base de données locale dans le conteneur
#    environment:
#      - SQLITE_DATABASE=/data/database.db           # Chemin vers la base de données dans le conteneur
